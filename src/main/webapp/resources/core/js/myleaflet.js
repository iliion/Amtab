
function mapping(){

//var json = require('./stops.json');


var json = '[{"DescrizioneFermata":"Viale S. Dioguardi fron str. del Caffè","IdFermata":"03227101","PosizioneFermata":{"Latitudine":"41.0963","Longitudine":"16.8629"}},{"DescrizioneFermata":"Viale S. Dioguardi ang str. del Caffè","IdFermata":"03227001","PosizioneFermata":{"Latitudine":"41.0963","Longitudine":"16.8621"}},{"DescrizioneFermata":"Via Van Westerhouth ,18","IdFermata":"08546003","PosizioneFermata":{"Latitudine":"41.1352","Longitudine":"16.829"}},{"DescrizioneFermata":"via Dei Gladioli, nucleo Cinofili CC","IdFermata":"10181101","PosizioneFermata":{"Latitudine":"41.0981","Longitudine":"16.7715"}},{"DescrizioneFermata":"Via gen.Bellomo -Casa di Cura Torrebella","IdFermata":"03270102","PosizioneFermata":{"Latitudine":"41.1058","Longitudine":"16.8505"}},{"DescrizioneFermata":"via Appulo  ,2","IdFermata":"05018002","PosizioneFermata":{"Latitudine":"41.1041","Longitudine":"16.9003"}},{"DescrizioneFermata":"via Giulio Petroni  ang. Giov.XXIII","IdFermata":"03285009","PosizioneFermata":{"Latitudine":"41.1073","Longitudine":"16.8677"}},{"DescrizioneFermata":"Via Cascia,ang. Via Roccaporena","IdFermata":"04093002","PosizioneFermata":{"Latitudine":"41.0702","Longitudine":"16.8555"}},{"DescrizioneFermata":"via S. Angelo, 24 (Ceglie)","IdFermata":"04483101","PosizioneFermata":{"Latitudine":"41.0657","Longitudine":"16.8659"}},{"DescrizioneFermata":"Viale Lazio ,12","IdFermata":"02309001","PosizioneFermata":{"Latitudine":"41.1195","Longitudine":"16.7916"}},{"DescrizioneFermata":"Via Titolo, 20","IdFermata":"01506101","PosizioneFermata":{"Latitudine":"41.1596","Longitudine":"16.7628"}},{"DescrizioneFermata":"Via Oberdan di fronte al Civ 22/A","IdFermata":"05399102","PosizioneFermata":{"Latitudine":"41.1175","Longitudine":"16.8841"}},{"DescrizioneFermata":"via Archimede, ex Capolinea 2","IdFermata":"05021103","PosizioneFermata":{"Latitudine":"41.1035","Longitudine":"16.9034"}},{"DescrizioneFermata":"viale Lindemann di fronte ex dep. AMTAB","IdFermata":"02315101","PosizioneFermata":{"Latitudine":"41.1217","Longitudine":"16.8162"}},{"DescrizioneFermata":"Viale G. DAnnunzio (C.P.T. Centro Perm. Temp.)","IdFermata":"01143004","PosizioneFermata":{"Latitudine":"41.144","Longitudine":"16.7786"}},{"DescrizioneFermata":"Sottovia di Via Q.Sella","IdFermata":"03490001","PosizioneFermata":{"Latitudine":"41.1171","Longitudine":"16.8626"}},{"DescrizioneFermata":"via Dei Gerani ,angolo Delle Ortensie","IdFermata":"10183001","PosizioneFermata":{"Latitudine":"41.1098","Longitudine":"16.7741"}},{"DescrizioneFermata":"Via della lealtà cap","IdFermata":"01310C00","PosizioneFermata":{"Latitudine":"41.1487","Longitudine":"16.737"}},{"DescrizioneFermata":"Via Iqbal Masih fronte scuola","IdFermata":"01353101","PosizioneFermata":{"Latitudine":"41.1494","Longitudine":"16.7389"}},{"DescrizioneFermata":"via Delle Violette, TIM","IdFermata":"10213001","PosizioneFermata":{"Latitudine":"41.1049","Longitudine":"16.7671"}},{"DescrizioneFermata":"Via Alberotanza, 14","IdFermata":"06006101","PosizioneFermata":{"Latitudine":"41.0958","Longitudine":"16.8717"}},{"DescrizioneFermata":"Via Adriatico, ang. Lung. Starita","IdFermata":"08003102","PosizioneFermata":{"Latitudine":"41.1374","Longitudine":"16.8409"}},{"DescrizioneFermata":"Bari, Via Anastasio Ballestrero ","IdFermata":"07023101","PosizioneFermata":{"Latitudine":"41.1157","Longitudine":"16.8956"}},{"DescrizioneFermata":"Via Indipendenza - Staz. FFSS","IdFermata":"01292101","PosizioneFermata":{"Latitudine":"41.1513","Longitudine":"16.7671"}},{"DescrizioneFermata":"Via Catino 48(Q.re S.Pio- Case PT)","IdFermata":"01098101","PosizioneFermata":{"Latitudine":"41.151","Longitudine":"16.7391"}},{"DescrizioneFermata":"strada S. Giorgio, 4","IdFermata":"05477102","PosizioneFermata":{"Latitudine":"41.0933","Longitudine":"16.9617"}},{"DescrizioneFermata":"piazza G. Cesare ,Policlinico","IdFermata":"03283101","PosizioneFermata":{"Latitudine":"41.112","Longitudine":"16.8625"}},{"DescrizioneFermata":"via Ferorelli ,di fronte C.E.D.I.","IdFermata":"02255101","PosizioneFermata":{"Latitudine":"41.1102","Longitudine":"16.8076"}},{"DescrizioneFermata":"via G. Petroni di fronte Clinica S.Rita","IdFermata":"04285113","PosizioneFermata":{"Latitudine":"41.0888","Longitudine":"16.8656"}},{"DescrizioneFermata":"Corso Cavour, 209 Cap.","IdFermata":"09099C02","PosizioneFermata":{"Latitudine":"41.1193","Longitudine":"16.8727"}},{"DescrizioneFermata":"V.le delle Regioni di fronte Don. Milani","IdFermata":"02210103","PosizioneFermata":{"Latitudine":"41.1217","Longitudine":"16.7879"}},{"DescrizioneFermata":"Via della Resistenza, Superm. GS (Capolinea)","IdFermata":"06195C00","PosizioneFermata":{"Latitudine":"41.1054","Longitudine":"16.8751"}},{"DescrizioneFermata":"Via Palasciano 8","IdFermata":"05410001","PosizioneFermata":{"Latitudine":"41.1054","Longitudine":"16.9216"}},{"DescrizioneFermata":"Lung.C.Colombo,246","IdFermata":"01135003","PosizioneFermata":{"Latitudine":"41.1674","Longitudine":"16.744"}},{"DescrizioneFermata":"via Trisorio Liuzzi, fronte via Di Cillo","IdFermata":"04513006","PosizioneFermata":{"Latitudine":"41.0724","Longitudine":"16.8616"}},{"DescrizioneFermata":"C.so Della Carboneria, difronte civ. 53","IdFermata":"08192001","PosizioneFermata":{"Latitudine":"41.1251","Longitudine":"16.8488"}},{"DescrizioneFermata":"Via Spilotros, 8","IdFermata":"01494101","PosizioneFermata":{"Latitudine":"41.1551","Longitudine":"16.7733"}},{"DescrizioneFermata":"viale Pasteur ang. Martiri dAvola","IdFermata":"03417002","PosizioneFermata":{"Latitudine":"41.1122","Longitudine":"16.853"}},{"DescrizioneFermata":"via Vitt. Veneto, 67","IdFermata":"04550102","PosizioneFermata":{"Latitudine":"41.0612","Longitudine":"16.8666"}},{"DescrizioneFermata":"Viale Japigia, 88/B","IdFermata":"05297104","PosizioneFermata":{"Latitudine":"41.1148","Longitudine":"16.8939"}},{"DescrizioneFermata":"via Delle Magnolie ILCA","IdFermata":"10205002","PosizioneFermata":{"Latitudine":"41.1093","Longitudine":"16.7586"}},{"DescrizioneFermata":"via G. Petroni ,107","IdFermata":"03285110","PosizioneFermata":{"Latitudine":"41.0961","Longitudine":"16.8675"}},{"DescrizioneFermata":"via  Gentile , 53/a1","IdFermata":"05273003","PosizioneFermata":{"Latitudine":"41.108","Longitudine":"16.9115"}},{"DescrizioneFermata":"via  Omodeo, 67","IdFermata":"06402002","PosizioneFermata":{"Latitudine":"41.1071","Longitudine":"16.8844"}},{"DescrizioneFermata":"Viale  Pio XII, 48","IdFermata":"03411001","PosizioneFermata":{"Latitudine":"41.1028","Longitudine":"16.8594"}},{"DescrizioneFermata":"Via  Rocca ,Ecopoli","IdFermata":"05450001","PosizioneFermata":{"Latitudine":"41.1","Longitudine":"16.9037"}},{"DescrizioneFermata":"Str.prov.Carb.-Modugno-Stadio S.Nicola","IdFermata":"04462101","PosizioneFermata":{"Latitudine":"41.0872","Longitudine":"16.8399"}},{"DescrizioneFermata":"Via Brigata Regina fronte Scuola","IdFermata":"08039103","PosizioneFermata":{"Latitudine":"41.1236","Longitudine":"16.8518"}},{"DescrizioneFermata":"Via B. Regina (Scuola Elementare)","IdFermata":"08039003","PosizioneFermata":{"Latitudine":"41.1237","Longitudine":"16.8518"}},{"DescrizioneFermata":"Via B. Bari, 102/A","IdFermata":"08040101","PosizioneFermata":{"Latitudine":"41.1201","Longitudine":"16.8521"}},{"DescrizioneFermata":"Corso Alcide De Gasperi, 479","IdFermata":"04162103","PosizioneFermata":{"Latitudine":"41.0861","Longitudine":"16.869"}},{"DescrizioneFermata":"Str.Caposcardicchio-Osp.S.Paolo(Capolin)","IdFermata":"02072C00","PosizioneFermata":{"Latitudine":"41.1177","Longitudine":"16.781"}},{"DescrizioneFermata":"Via Pacifico Mazzoni ,ang. Candura","IdFermata":"02408001","PosizioneFermata":{"Latitudine":"41.126","Longitudine":"16.7996"}},{"DescrizioneFermata":"via Vaccarella ,Snoopy","IdFermata":"04540102","PosizioneFermata":{"Latitudine":"41.0716","Longitudine":"16.8636"}},{"DescrizioneFermata":"Via Quintino Sella ,225","IdFermata":"08441103","PosizioneFermata":{"Latitudine":"41.1192","Longitudine":"16.8647"}},{"DescrizioneFermata":"Lungomare Imp Augusto, Fortino","IdFermata":"09295103","PosizioneFermata":{"Latitudine":"41.129","Longitudine":"16.8729"}},{"DescrizioneFermata":"Lungomare Imp.Augusto,Piazza Ferrarese","IdFermata":"09295104","PosizioneFermata":{"Latitudine":"41.1271","Longitudine":"16.8725"}},{"DescrizioneFermata":"via  Colella, ang. via Gentile","IdFermata":"05105001","PosizioneFermata":{"Latitudine":"41.1085","Longitudine":"16.9094"}},{"DescrizioneFermata":"Piazza Federico II di Svevia","IdFermata":"09350101","PosizioneFermata":{"Latitudine":"41.1288","Longitudine":"16.8675"}},{"DescrizioneFermata":"Piazza Massari Ang Federico II di Svevia","IdFermata":"09351003","PosizioneFermata":{"Latitudine":"41.1273","Longitudine":"16.8659"}},{"DescrizioneFermata":"P.zza Massari, Prefettura","IdFermata":"09351C00","PosizioneFermata":{"Latitudine":"41.1259","Longitudine":"16.8666"}},{"DescrizioneFermata":"C.so V. Emanuele, Teatro Piccinni Cap.","IdFermata":"09556C00","PosizioneFermata":{"Latitudine":"41.1259","Longitudine":"16.8674"}},{"DescrizioneFermata":"P.zza Garibaldi, chiesa S. Francesco","IdFermata":"08267102","PosizioneFermata":{"Latitudine":"41.1255","Longitudine":"16.8608"}},{"DescrizioneFermata":"Via Bari, 35/F","IdFermata":"05027104","PosizioneFermata":{"Latitudine":"41.0863","Longitudine":"16.9923"}},{"DescrizioneFermata":"via De Laurentis ,19/21","IdFermata":"03168104","PosizioneFermata":{"Latitudine":"41.0949","Longitudine":"16.8643"}},{"DescrizioneFermata":"viale Europa ,ang.Granieri","IdFermata":"02240003","PosizioneFermata":{"Latitudine":"41.127","Longitudine":"16.7973"}},{"DescrizioneFermata":"viale Kennedy, 77","IdFermata":"03298102","PosizioneFermata":{"Latitudine":"41.101","Longitudine":"16.8654"}},{"DescrizioneFermata":"viaTris.Liuzzi,95/C fronte rist.Rosa Blu","IdFermata":"04513104","PosizioneFermata":{"Latitudine":"41.0661","Longitudine":"16.8623"}},{"DescrizioneFermata":"Via  DAvanzo ,  3","IdFermata":"05144001","PosizioneFermata":{"Latitudine":"41.1046","Longitudine":"16.9072"}},{"DescrizioneFermata":"via Oberdan ,di fronte Sup. De Sandi","IdFermata":"05399101","PosizioneFermata":{"Latitudine":"41.1171","Longitudine":"16.887"}},{"DescrizioneFermata":"Estr. Capruzzi 20/A","IdFermata":"07075001","PosizioneFermata":{"Latitudine":"41.1175","Longitudine":"16.8767"}},{"DescrizioneFermata":"Via delle Orchide-Zincomet (Capolinea)","IdFermata":"10208C00","PosizioneFermata":{"Latitudine":"41.101","Longitudine":"16.7843"}},{"DescrizioneFermata":"Via Scizze di fronte P.co Atlantide","IdFermata":"05489002","PosizioneFermata":{"Latitudine":"41.0899","Longitudine":"16.988"}},{"DescrizioneFermata":"Lung. C. Colombo ,di fronte QUI SI GODE","IdFermata":"01135101","PosizioneFermata":{"Latitudine":"41.164","Longitudine":"16.7488"}},{"DescrizioneFermata":"Via Complanare Est, 108","IdFermata":"05114104","PosizioneFermata":{"Latitudine":"41.0989","Longitudine":"16.9349"}},{"DescrizioneFermata":"Via Nicholas Green,54","IdFermata":"01387101","PosizioneFermata":{"Latitudine":"41.1569","Longitudine":"16.7416"}},{"DescrizioneFermata":"via Delle Ortensie, di fronte Pimespo","IdFermata":"10207102","PosizioneFermata":{"Latitudine":"41.109","Longitudine":"16.7737"}},{"DescrizioneFermata":"Via S. Angelo, 39","IdFermata":"04483001","PosizioneFermata":{"Latitudine":"41.0656","Longitudine":"16.866"}},{"DescrizioneFermata":"via Prov. Ceglie - Adelfia ,km 2","IdFermata":"04104101","PosizioneFermata":{"Latitudine":"41.0434","Longitudine":"16.8634"}},{"DescrizioneFermata":"Via Vaccarella ang. Trav. Vaccarella","IdFermata":"04540002","PosizioneFermata":{"Latitudine":"41.0711","Longitudine":"16.8637"}},{"DescrizioneFermata":"Via Delle Magnolie di fronte ILCA","IdFermata":"10205106","PosizioneFermata":{"Latitudine":"41.1093","Longitudine":"16.7587"}},{"DescrizioneFermata":"Via Delle Azalee fronte civ.1/3","IdFermata":"01201101","PosizioneFermata":{"Latitudine":"41.1588","Longitudine":"16.7384"}},{"DescrizioneFermata":"Corso V. Emanuele - Provvisoria","IdFermata":"09556C01","PosizioneFermata":{"Latitudine":"41.1259","Longitudine":"16.8674"}},{"DescrizioneFermata":"Via Dante Alighieri - Provvisoria","IdFermata":"09146101","PosizioneFermata":{"Latitudine":"41.1216","Longitudine":"16.8621"}},{"DescrizioneFermata":"Corso Vitt.Veneto ex parch. Multiservizi","IdFermata":"08561107","PosizioneFermata":{"Latitudine":"41.128","Longitudine":"16.855"}},{"DescrizioneFermata":"C.so Vitt.Veneto fronte ex parch.Multise","IdFermata":"08561007","PosizioneFermata":{"Latitudine":"41.128","Longitudine":"16.8551"}}]';

var stops = JSON.parse(json);


  var map = new L.Map('map', {zoom: 12, minZoom:12, center: L.latLng(41.11714,16.87187) });	
	map.addLayer(L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token={accessToken}', {
            attribution: 'Map data',
            maxZoom: 18,
            id: 'mapbox.streets',
            accessToken: 'pk.eyJ1IjoiaWxpb24iLCJhIjoiY2locDE2aTgwMDAwN3V4a3FmeWpmdWFoMyJ9.L1VHoNApF6f6ayFyAeaW_w'
        }));	
	var markersLayer = new L.LayerGroup();	//layer contain searched elements
	map.addLayer(markersLayer);

	////////////populate map from stops
	for(var i in stops)
      L.marker(L.latLng(stops[i].PosizioneFermata.Latitudine,stops[i].PosizioneFermata.Longitudine), {
       title: stops[i].DescrizioneFermata}).addTo( markersLayer ).bindPopup("<b>"+stops[i].DescrizioneFermata+"</b>").openPopup();

	//inizialize Leaflet List Markers
	var list = new L.Control.ListMarkers({
      layer: markersLayer,
      itemIcon: null
    }
  );
	
	list.on('item-mouseover', function(e) {
		e.layer.setIcon(L.icon({
			iconUrl: '../images/select-marker.png'
		}))
	}).on('item-mouseout', function(e) {
		e.layer.setIcon(L.icon({
			iconUrl: L.Icon.Default.imagePath+'/marker-icon.png'
		}))
	});
	map.addControl( list );
	


}
